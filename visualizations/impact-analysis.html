<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Churches United Sustainability Initiative - Complete Impact Analysis</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/recharts@2.8.0/umd/Recharts.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
        }
        .program-card {
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
        }
        .program-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            border-color: #3B82F6;
        }
        .program-card.selected {
            border-color: #3B82F6;
            background: linear-gradient(135deg, #EBF4FF 0%, #DBEAFE 100%);
        }
        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .animate-slide-up {
            animation: slideInUp 0.6s ease-out forwards;
        }
        .stagger-1 { animation-delay: 0.1s; }
        .stagger-2 { animation-delay: 0.2s; }
        .stagger-3 { animation-delay: 0.3s; }
        .stagger-4 { animation-delay: 0.4s; }
        .stagger-5 { animation-delay: 0.5s; }
        .stagger-6 { animation-delay: 0.6s; }
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const { 
            LineChart, Line, BarChart, Bar, XAxis, YAxis, CartesianGrid, 
            Tooltip, Legend, ResponsiveContainer, PieChart, Pie, Cell,
            RadarChart, PolarGrid, PolarAngleAxis, PolarRadiusAxis, Radar,
            AreaChart, Area, ComposedChart, Treemap
        } = Recharts;

        // Complete Program Data
        const allPrograms = [
            {
                name: "Trinity Trikes",
                description: "Weather-protected electric tricycles eliminating transportation barriers to employment",
                category: "Transportation & Employment",
                participants: 25,
                investment: 56750,
                annualSavings: 384400,
                annualValue: 264820,
                roi: "2.7 years",
                status: "Implementation Ready",
                keyImpacts: [
                    "214% increase in job opportunities",
                    "18.7 tons COâ‚‚ reduction annually",
                    "$142,700 taxpayer savings",
                    "37% to 63% employment placement improvement"
                ],
                metrics: {
                    employmentIncrease: 70,
                    environmentalBenefit: 95,
                    costEffectiveness: 85,
                    communityImpact: 80
                }
            },
            {
                name: "Call to Faith",
                description: "Smartphone access program eliminating communication barriers for employment",
                category: "Digital Inclusion & Communication",
                participants: 50,
                investment: 62000,
                annualSavings: 175000,
                annualValue: 200000,
                roi: "3-4 months",
                status: "Implementation Ready",
                keyImpacts: [
                    "100% digital inclusion for participants",
                    "95% reduction in communication barriers",
                    "47% increase in job placement rates",
                    "Emergency communication access 24/7"
                ],
                metrics: {
                    employmentIncrease: 65,
                    environmentalBenefit: 20,
                    costEffectiveness: 95,
                    communityImpact: 75
                }
            },
            {
                name: "FALCON Security System",
                description: "AI-powered security monitoring protecting vulnerable populations",
                category: "Safety & Security",
                participants: 25000,
                investment: 10800000,
                annualSavings: 318481,
                annualValue: 400000,
                roi: "143% over 5 years",
                status: "Grant Application Submitted",
                keyImpacts: [
                    "98.3% weapon detection accuracy",
                    "73% reduction in security incidents",
                    "6 facilities protected 24/7",
                    "$1.59M in 5-year cost savings"
                ],
                metrics: {
                    employmentIncrease: 30,
                    environmentalBenefit: 15,
                    costEffectiveness: 60,
                    communityImpact: 95
                }
            },
            {
                name: "Resume & Cover Letter Generator",
                description: "AI-powered employment document creation with speech recognition capability",
                category: "Employment Support Technology",
                participants: 200,
                investment: 25000,
                annualSavings: 85000,
                annualValue: 120000,
                roi: "4 months",
                status: "Development Complete",
                keyImpacts: [
                    "93% reduction in document creation time",
                    "64% improvement in interview invitations",
                    "5.8x increase in application volume",
                    "215 annual staff hours redirected"
                ],
                metrics: {
                    employmentIncrease: 85,
                    environmentalBenefit: 10,
                    costEffectiveness: 90,
                    communityImpact: 70
                }
            },
            {
                name: "Insightful Mind Career Course",
                description: "Neuroscience-based program connecting mental health understanding to employment readiness",
                category: "Mental Health & Career Development",
                participants: 100,
                investment: 45000,
                annualSavings: 95000,
                annualValue: 150000,
                roi: "6 months",
                status: "Pilot Ready",
                keyImpacts: [
                    "87% improved self-understanding",
                    "62% increase in employment readiness",
                    "58% reduction in substance use",
                    "74% connect with mental health services"
                ],
                metrics: {
                    employmentIncrease: 75,
                    environmentalBenefit: 5,
                    costEffectiveness: 80,
                    communityImpact: 85
                }
            },
            {
                name: "ONWARD Employment Program",
                description: "Comprehensive employment support framework integrating all employment services",
                category: "Holistic Employment Support",
                participants: 300,
                investment: 150000,
                annualSavings: 300000,
                annualValue: 450000,
                roi: "6 months",
                status: "Enhancement Ready",
                keyImpacts: [
                    "75% job placement success rate",
                    "89% housing stability after employment",
                    "$3.50/hour average wage improvement",
                    "Integrated multi-service approach"
                ],
                metrics: {
                    employmentIncrease: 90,
                    environmentalBenefit: 25,
                    costEffectiveness: 85,
                    communityImpact: 90
                }
            }
        ];

        // Calculate totals
        const totalInvestment = allPrograms.reduce((sum, p) => sum + p.investment, 0);
        const totalAnnualSavings = allPrograms.reduce((sum, p) => sum + p.annualSavings, 0);
        const totalAnnualValue = allPrograms.reduce((sum, p) => sum + p.annualValue, 0);
        const totalParticipants = allPrograms.reduce((sum, p) => sum + p.participants, 0);

        // Community Impact Categories
        const communityImpactData = [
            { 
                name: "Employment & Economic Development", 
                value: 850000, 
                description: "Job placement, wage improvements, workforce stability",
                programs: ["Trinity Trikes", "Call to Faith", "ONWARD", "Resume Generator"]
            },
            { 
                name: "Public Safety & Security", 
                value: 600000, 
                description: "Crime reduction, emergency response, community safety",
                programs: ["FALCON Security", "Insightful Mind"]
            },
            { 
                name: "Healthcare & Mental Health", 
                value: 450000, 
                description: "Reduced ER visits, mental health support, substance abuse reduction",
                programs: ["Insightful Mind", "Trinity Trikes", "Call to Faith"]
            },
            { 
                name: "Environmental Sustainability", 
                value: 285000, 
                description: "Carbon reduction, sustainable transportation, resource conservation",
                programs: ["Trinity Trikes"]
            },
            { 
                name: "Social Services Efficiency", 
                value: 380000, 
                description: "Reduced case management time, improved service delivery",
                programs: ["All Programs"]
            },
            { 
                name: "Housing Stability", 
                value: 320000, 
                description: "Improved housing retention, reduced homelessness duration",
                programs: ["ONWARD", "Trinity Trikes", "Insightful Mind"]
            }
        ];

        const totalCommunityValue = communityImpactData.reduce((sum, item) => sum + item.value, 0);

        // Financial Timeline Data
        const financialTimeline = [
            { 
                year: 'Year 1', 
                investment: totalInvestment, 
                savings: totalAnnualSavings,
                value: totalAnnualValue,
                cumulative: totalAnnualValue - totalInvestment
            },
            { 
                year: 'Year 2', 
                investment: totalInvestment * 0.2, 
                savings: totalAnnualSavings * 1.1,
                value: totalAnnualValue * 1.15,
                cumulative: (totalAnnualValue - totalInvestment) + (totalAnnualValue * 1.15 - totalInvestment * 0.2)
            },
            { 
                year: 'Year 3', 
                investment: totalInvestment * 0.1, 
                savings: totalAnnualSavings * 1.2,
                value: totalAnnualValue * 1.3,
                cumulative: 0 // Will calculate
            },
            { 
                year: 'Year 4', 
                investment: totalInvestment * 0.05, 
                savings: totalAnnualSavings * 1.3,
                value: totalAnnualValue * 1.4,
                cumulative: 0 // Will calculate
            },
            { 
                year: 'Year 5', 
                investment: totalInvestment * 0.05, 
                savings: totalAnnualSavings * 1.4,
                value: totalAnnualValue * 1.5,
                cumulative: 0 // Will calculate
            }
        ];

        // Calculate cumulative values
        let runningTotal = 0;
        financialTimeline.forEach(year => {
            runningTotal += (year.value - year.investment);
            year.cumulative = runningTotal;
        });

        const COLORS = ['#3B82F6', '#10B981', '#F59E0B', '#EF4444', '#8B5CF6', '#06B6D4', '#F97316'];

        const CustomTooltip = ({ active, payload, label }) => {
            if (active && payload && payload.length) {
                return (
                    <div className="bg-white p-4 border rounded-lg shadow-lg text-sm max-w-xs">
                        <p className="font-bold text-gray-700">{label}</p>
                        {payload.map((entry, index) => (
                            <p key={`item-${index}`} className="text-sm" style={{ color: entry.color }}>
                                {`${entry.name}: ${typeof entry.value === 'number' ? 
                                    (entry.name.includes('$') || entry.name.includes('Value') || entry.name.includes('Savings') ? 
                                        `$${entry.value.toLocaleString()}` : entry.value.toLocaleString()) 
                                    : entry.value}`}
                            </p>
                        ))}
                        {payload[0].payload.description && (
                            <p className="text-xs text-gray-600 mt-2">{payload[0].payload.description}</p>
                        )}
                    </div>
                );
            }
            return null;
        };

        const ComprehensiveImpactAnalysis = () => {
            const [activeView, setActiveView] = useState('overview');
            const [selectedProgram, setSelectedProgram] = useState(null);

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100">
                    {/* Hero Header */}
                    <div className="gradient-bg text-white">
                        <div className="max-w-7xl mx-auto px-4 py-12">
                            <div className="text-center">
                                <h1 className="text-5xl font-bold mb-4">Churches United Sustainability Initiative</h1>
                                <p className="text-2xl mb-6 opacity-90">Complete Program Portfolio Impact Analysis</p>
                                <div className="grid grid-cols-2 md:grid-cols-4 gap-6 mt-8">
                                    <div className="bg-white bg-opacity-20 rounded-lg p-4">
                                        <div className="text-3xl font-bold">{allPrograms.length}</div>
                                        <div className="text-sm opacity-90">Strategic Programs</div>
                                    </div>
                                    <div className="bg-white bg-opacity-20 rounded-lg p-4">
                                        <div className="text-3xl font-bold">{totalParticipants.toLocaleString()}</div>
                                        <div className="text-sm opacity-90">People Served</div>
                                    </div>
                                    <div className="bg-white bg-opacity-20 rounded-lg p-4">
                                        <div className="text-3xl font-bold">${(totalAnnualValue / 1000000).toFixed(1)}M</div>
                                        <div className="text-sm opacity-90">Annual Value Creation</div>
                                    </div>
                                    <div className="bg-white bg-opacity-20 rounded-lg p-4">
                                        <div className="text-3xl font-bold">${(totalCommunityValue / 1000000).toFixed(1)}M</div>
                                        <div className="text-sm opacity-90">Community Impact</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Navigation */}
                    <div className="max-w-7xl mx-auto px-4 py-6">
                        <div className="flex flex-wrap gap-2">
                            {['overview', 'programs', 'financial', 'community-impact', 'roi-analysis'].map(view => (
                                <button
                                    key={view}
                                    className={`px-6 py-3 rounded-lg font-medium transition-all ${
                                        activeView === view 
                                            ? 'bg-blue-600 text-white shadow-lg' 
                                            : 'bg-white text-gray-700 hover:bg-blue-50'
                                    }`}
                                    onClick={() => setActiveView(view)}
                                >
                                    {view.split('-').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ')}
                                </button>
                            ))}
                        </div>
                    </div>

                    <div className="max-w-7xl mx-auto px-4 pb-8">
                        {/* Overview */}
                        {activeView === 'overview' && (
                            <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                <div className="bg-white rounded-xl shadow-lg p-6 animate-slide-up">
                                    <h2 className="text-2xl font-bold text-gray-800 mb-4">Complete Portfolio Overview</h2>
                                    <div className="h-80">
                                        <ResponsiveContainer width="100%" height="100%">
                                            <Treemap
                                                data={allPrograms.map(p => ({
                                                    name: p.name,
                                                    size: p.annualValue,
                                                    fill: COLORS[allPrograms.indexOf(p) % COLORS.length]
                                                }))}
                                                dataKey="size"
                                                aspectRatio={4/3}
                                                stroke="#fff"
                                                fill="#8884d8"
                                            >
                                                <Tooltip 
                                                    content={({ active, payload }) => {
                                                        if (active && payload && payload[0]) {
                                                            const data = payload[0].payload;
                                                            return (
                                                                <div className="bg-white p-3 border rounded shadow">
                                                                    <p className="font-bold">{data.name}</p>
                                                                    <p>Annual Value: ${data.size.toLocaleString()}</p>
                                                                </div>
                                                            );
                                                        }
                                                        return null;
                                                    }}
                                                />
                                            </Treemap>
                                        </ResponsiveContainer>
                                    </div>
                                    <p className="text-sm text-gray-600 mt-2">
                                        Program portfolio sized by annual value creation. Click segments to explore individual programs.
                                    </p>
                                </div>

                                <div className="bg-white rounded-xl shadow-lg p-6 animate-slide-up stagger-1">
                                    <h2 className="text-2xl font-bold text-gray-800 mb-4">Combined Impact Metrics</h2>
                                    <div className="h-80">
                                        <ResponsiveContainer width="100%" height="100%">
                                            <RadarChart outerRadius={90} data={[
                                                {
                                                    metric: "Employment Impact",
                                                    value: allPrograms.reduce((sum, p) => sum + p.metrics.employmentIncrease, 0) / allPrograms.length
                                                },
                                                {
                                                    metric: "Cost Effectiveness",
                                                    value: allPrograms.reduce((sum, p) => sum + p.metrics.costEffectiveness, 0) / allPrograms.length
                                                },
                                                {
                                                    metric: "Community Impact",
                                                    value: allPrograms.reduce((sum, p) => sum + p.metrics.communityImpact, 0) / allPrograms.length
                                                },
                                                {
                                                    metric: "Environmental Benefit",
                                                    value: allPrograms.reduce((sum, p) => sum + p.metrics.environmentalBenefit, 0) / allPrograms.length
                                                }
                                            ]}>
                                                <PolarGrid />
                                                <PolarAngleAxis dataKey="metric" />
                                                <PolarRadiusAxis angle={90} domain={[0, 100]} />
                                                <Radar name="Combined Score" dataKey="value" stroke="#3B82F6" fill="#3B82F6" fillOpacity={0.6} />
                                                <Tooltip />
                                            </RadarChart>
                                        </ResponsiveContainer>
                                    </div>
                                </div>

                                <div className="bg-white rounded-xl shadow-lg p-6 animate-slide-up stagger-2">
                                    <h2 className="text-2xl font-bold text-gray-800 mb-4">Financial Summary</h2>
                                    <div className="space-y-4">
                                        <div className="grid grid-cols-2 gap-4">
                                            <div className="bg-red-50 rounded-lg p-4 text-center">
                                                <div className="text-3xl font-bold text-red-600">${(totalInvestment / 1000000).toFixed(1)}M</div>
                                                <div className="text-sm text-red-600">Total Investment</div>
                                            </div>
                                            <div className="bg-green-50 rounded-lg p-4 text-center">
                                                <div className="text-3xl font-bold text-green-600">${(totalAnnualSavings / 1000000).toFixed(1)}M</div>
                                                <div className="text-sm text-green-600">Annual Savings</div>
                                            </div>
                                        </div>
                                        <div className="bg-blue-50 rounded-lg p-4 text-center">
                                            <div className="text-4xl font-bold text-blue-600">${(totalAnnualValue / 1000000).toFixed(1)}M</div>
                                            <div className="text-sm text-blue-600">Total Annual Value Creation</div>
                                        </div>
                                        <div className="bg-purple-50 rounded-lg p-4 text-center">
                                            <div className="text-3xl font-bold text-purple-600">{((totalAnnualValue / totalInvestment) * 100).toFixed(0)}%</div>
                                            <div className="text-sm text-purple-600">First Year ROI</div>
                                        </div>
                                    </div>
                                </div>

                                <div className="bg-white rounded-xl shadow-lg p-6 animate-slide-up stagger-3">
                                    <h2 className="text-2xl font-bold text-gray-800 mb-4">5-Year Value Trajectory</h2>
                                    <div className="h-80">
                                        <ResponsiveContainer width="100%" height="100%">
                                            <ComposedChart
                                                data={financialTimeline}
                                                margin={{ top: 20, right: 30, left: 20, bottom: 5 }}
                                            >
                                                <CartesianGrid strokeDasharray="3 3" />
                                                <XAxis dataKey="year" />
                                                <YAxis tickFormatter={(value) => `$${(value/1000000).toFixed(1)}M`} />
                                                <Tooltip formatter={(value) => [`$${value.toLocaleString()}`, '']} />
                                                <Legend />
                                                <Bar dataKey="investment" fill="#EF4444" name="Annual Investment" />
                                                <Bar dataKey="value" fill="#10B981" name="Annual Value" />
                                                <Line type="monotone" dataKey="cumulative" stroke="#3B82F6" strokeWidth={3} name="Cumulative Net Value" />
                                            </ComposedChart>
                                        </ResponsiveContainer>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* Programs View */}
                        {activeView === 'programs' && (
                            <div className="space-y-6">
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                    {allPrograms.map((program, index) => (
                                        <div 
                                            key={program.name}
                                            className={`program-card bg-white rounded-xl shadow-lg p-6 animate-slide-up ${
                                                selectedProgram === program.name ? 'selected' : ''
                                            }`}
                                            style={{ animationDelay: `${index * 0.1}s` }}
                                            onClick={() => setSelectedProgram(
                                                selectedProgram === program.name ? null : program.name
                                            )}
                                        >
                                            <div className="flex justify-between items-start mb-4">
                                                <h3 className="text-lg font-bold text-gray-800">{program.name}</h3>
                                                <span className={`px-2 py-1 rounded text-xs font-medium ${
                                                    program.status === 'Implementation Ready' ? 'bg-green-100 text-green-800' :
                                                    program.status === 'Development Complete' ? 'bg-blue-100 text-blue-800' :
                                                    program.status === 'Pilot Ready' ? 'bg-yellow-100 text-yellow-800' :
                                                    'bg-purple-100 text-purple-800'
                                                }`}>
                                                    {program.status}
                                                </span>
                                            </div>
                                            <p className="text-sm text-gray-600 mb-4">{program.description}</p>
                                            <div className="grid grid-cols-2 gap-3 mb-4">
                                                <div className="text-center bg-gray-50 rounded p-2">
                                                    <div className="text-lg font-bold text-blue-600">{program.participants.toLocaleString()}</div>
                                                    <div className="text-xs text-gray-600">Participants</div>
                                                </div>
                                                <div className="text-center bg-gray-50 rounded p-2">
                                                    <div className="text-lg font-bold text-green-600">{program.roi}</div>
                                                    <div className="text-xs text-gray-600">ROI Timeline</div>
                                                </div>
                                            </div>
                                            <div className="space-y-2">
                                                <div className="flex justify-between text-sm">
                                                    <span className="text-gray-600">Investment:</span>
                                                    <span className="font-bold text-red-600">${program.investment.toLocaleString()}</span>
                                                </div>
                                                <div className="flex justify-between text-sm">
                                                    <span className="text-gray-600">Annual Value:</span>
                                                    <span className="font-bold text-green-600">${program.annualValue.toLocaleString()}</span>
                                                </div>
                                            </div>
                                            {selectedProgram === program.name && (
                                                <div className="mt-4 pt-4 border-t">
                                                    <h4 className="font-bold text-gray-700 mb-2">Key Impacts:</h4>
                                                    <ul className="space-y-1">
                                                        {program.keyImpacts.map((impact, idx) => (
                                                            <li key={idx} className="text-xs text-gray-600 flex items-start">
                                                                <span className="text-green-500 mr-1">â€¢</span>
                                                                {impact}
                                                            </li>
                                                        ))}
                                                    </ul>
                                                </div>
                                            )}
                                        </div>
                                    ))}
                                </div>

                                {selectedProgram && (
                                    <div className="bg-white rounded-xl shadow-lg p-6">
                                        <h2 className="text-2xl font-bold text-gray-800 mb-4">
                                            {selectedProgram} - Detailed Analysis
                                        </h2>
                                        <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                            {(() => {
                                                const program = allPrograms.find(p => p.name === selectedProgram);
                                                return (
                                                    <>
                                                        <div className="h-64">
                                                            <ResponsiveContainer width="100%" height="100%">
                                                                <RadarChart outerRadius={80} data={[
                                                                    { metric: "Employment", value: program.metrics.employmentIncrease },
                                                                    { metric: "Environment", value: program.metrics.environmentalBenefit },
                                                                    { metric: "Cost Effectiveness", value: program.metrics.costEffectiveness },
                                                                    { metric: "Community Impact", value: program.metrics.communityImpact }
                                                                ]}>
                                                                    <PolarGrid />
                                                                    <PolarAngleAxis dataKey="metric" />
                                                                    <PolarRadiusAxis domain={[0, 100]} />
                                                                    <Radar dataKey="value" stroke="#3B82F6" fill="#3B82F6" fillOpacity={0.6} />
                                                                    <Tooltip />
                                                                </RadarChart>
                                                            </ResponsiveContainer>
                                                        </div>
                                                        <div className="space-y-4">
                                                            <div className="bg-blue-50 rounded-lg p-4">
                                                                <h3 className="font-bold text-blue-800">Category</h3>
                                                                <p className="text-blue-700">{program.category}</p>
                                                            </div>
                                                            <div className="grid grid-cols-2 gap-3">
                                                                <div className="bg-green-50 rounded-lg p-3 text-center">
                                                                    <div className="text-2xl font-bold text-green-700">
                                                                        ${program.annualSavings.toLocaleString()}
                                                                    </div>
                                                                    <div className="text-sm text-green-600">Annual Savings</div>
                                                                </div>
                                                                <div className="bg-purple-50 rounded-lg p-3 text-center">
                                                                    <div className="text-2xl font-bold text-purple-700">
                                                                        ${program.annualValue.toLocaleString()}
                                                                    </div>
                                                                    <div className="text-sm text-purple-600">Annual Value</div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </>
                                                );
                                            })()}
                                        </div>
                                    </div>
                                )}
                            </div>
                        )}

                        {/* Financial Analysis */}
                        {activeView === 'financial' && (
                            <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                <div className="bg-white rounded-xl shadow-lg p-6">
                                    <h2 className="text-2xl font-bold text-gray-800 mb-4">Investment Distribution</h2>
                                    <div className="h-80">
                                        <ResponsiveContainer width="100%" height="100%">
                                            <PieChart>
                                                <Pie
                                                    data={allPrograms}
                                                    cx="50%"
                                                    cy="50%"
                                                    labelLine={false}
                                                    outerRadius={80}
                                                    fill="#8884d8"
                                                    dataKey="investment"
                                                    nameKey="name"
                                                    label={({ name, percent }) => `${name}: ${(percent * 100).toFixed(0)}%`}
                                                >
                                                    {allPrograms.map((entry, index) => (
                                                        <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />
                                                    ))}
                                                </Pie>
                                                <Tooltip formatter={(value) => [`$${value.toLocaleString()}`, 'Investment']} />
                                                <Legend />
                                            </PieChart>
                                        </ResponsiveContainer>
                                    </div>
                                </div>

                                <div className="bg-white rounded-xl shadow-lg p-6">
                                    <h2 className="text-2xl font-bold text-gray-800 mb-4">Value Creation Distribution</h2>
                                    <div className="h-80">
                                        <ResponsiveContainer width="100%" height="100%">
                                            <PieChart>
                                                <Pie
                                                    data={allPrograms}
                                                    cx="50%"
                                                    cy="50%"
                                                    labelLine={false}
                                                    outerRadius={80}
                                                    fill="#8884d8"
                                                    dataKey="annualValue"
                                                    nameKey="name"
                                                    label={({ name, percent }) => `${name}: ${(percent * 100).toFixed(0)}%`}
                                                >
                                                    {allPrograms.map((entry, index) => (
                                                        <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />
                                                    ))}
                                                </Pie>
                                                <Tooltip formatter={(value) => [`$${value.toLocaleString()}`, 'Annual Value']} />
                                                <Legend />
                                            </PieChart>
                                        </ResponsiveContainer>
                                    </div>
                                </div>

                                <div className="bg-white rounded-xl shadow-lg p-6 lg:col-span-2">
                                    <h2 className="text-2xl font-bold text-gray-800 mb-4">Program ROI Comparison</h2>
                                    <div className="h-80">
                                        <ResponsiveContainer width="100%" height="100%">
                                            <ComposedChart
                                                data={allPrograms.map(p => ({
                                                    name: p.name,
                                                    investment: p.investment,
                                                    annualValue: p.annualValue,
                                                    roiRatio: (p.annualValue / p.investment * 100),
                                                    participants: p.participants
                                                }))}
                                                margin={{ top: 20, right: 30, left: 20, bottom: 5 }}
                                            >
                                                <CartesianGrid strokeDasharray="3 3" />
                                                <XAxis dataKey="name" angle={-45} textAnchor="end" height={60} />
                                                <YAxis yAxisId="left" tickFormatter={(value) => `$${(value/1000).toFixed(0)}K`} />
                                                <YAxis yAxisId="right" orientation="right" tickFormatter={(value) => `${value}%`} />
                                                <Tooltip 
                                                    formatter={(value, name) => [
                                                        name.includes('investment') || name.includes('Value') ? `$${value.toLocaleString()}` :
                                                        name.includes('roiRatio') ? `${value.toFixed(0)}%` :
                                                        value.toLocaleString(),
                                                        name
                                                    ]} 
                                                />
                                                <Legend />
                                                <Bar yAxisId="left" dataKey="investment" fill="#EF4444" name="Investment" />
                                                <Bar yAxisId="left" dataKey="annualValue" fill="#10B981" name="Annual Value" />
                                                <Line yAxisId="right" type="monotone" dataKey="roiRatio" stroke="#8B5CF6" strokeWidth={3} name="ROI %" />
                                            </ComposedChart>
                                        </ResponsiveContainer>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* Community Impact */}
                        {activeView === 'community-impact' && (
                            <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                <div className="bg-white rounded-xl shadow-lg p-6">
                                    <h2 className="text-2xl font-bold text-gray-800 mb-4">Community Value by Category</h2>
                                    <div className="h-80">
                                        <ResponsiveContainer width="100%" height="100%">
                                            <BarChart
                                                data={communityImpactData}
                                                margin={{ top: 5, right: 30, left: 20, bottom: 5 }}
                                                layout="vertical"
                                            >
                                                <CartesianGrid strokeDasharray="3 3" />
                                                <XAxis type="number" tickFormatter={(value) => `$${(value/1000).toFixed(0)}K`} />
                                                <YAxis type="category" dataKey="name" width={150} />
                                                <Tooltip formatter={(value) => [`$${value.toLocaleString()}`, 'Annual Value']} />
                                                <Bar dataKey="value" fill="#3B82F6" />
                                            </BarChart>
                                        </ResponsiveContainer>
                                    </div>
                                </div>

                                <div className="bg-white rounded-xl shadow-lg p-6">
                                    <h2 className="text-2xl font-bold text-gray-800 mb-4">Impact Categories Overview</h2>
                                    <div className="space-y-4 max-h-80 overflow-y-auto">
                                        {communityImpactData.map((category, index) => (
                                            <div key={index} className="border rounded-lg p-4">
                                                <div className="flex justify-between items-start mb-2">
                                                    <h3 className="font-bold text-gray-800">{category.name}</h3>
                                                    <span className="text-lg font-bold text-green-600">
                                                        ${(category.value / 1000).toFixed(0)}K
                                                    </span>
                                                </div>
                                                <p className="text-sm text-gray-600 mb-2">{category.description}</p>
                                                <div className="flex flex-wrap gap-1">
                                                    {category.programs.map((program, idx) => (
                                                        <span key={idx} className="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded">
                                                            {program}
                                                        </span>
                                                    ))}
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                </div>

                                <div className="bg-white rounded-xl shadow-lg p-6 lg:col-span-2">
                                    <h2 className="text-2xl font-bold text-gray-800 mb-4">Total Community Impact Summary</h2>
                                    <div className="grid grid-cols-1 md:grid-cols-4 gap-6">
                                        <div className="text-center p-6 bg-gradient-to-br from-green-50 to-green-100 rounded-lg">
                                            <h3 className="text-lg font-bold text-green-800">Total Annual Value</h3>
                                            <p className="text-4xl font-bold text-green-600 my-4">
                                                ${(totalCommunityValue / 1000000).toFixed(1)}M
                                            </p>
                                            <p className="text-sm text-green-700">Across all impact categories</p>
                                        </div>
                                        <div className="text-center p-6 bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg">
                                            <h3 className="text-lg font-bold text-blue-800">People Directly Served</h3>
                                            <p className="text-4xl font-bold text-blue-600 my-4">{totalParticipants.toLocaleString()}</p>
                                            <p className="text-sm text-blue-700">Through all programs</p>
                                        </div>
                                        <div className="text-center p-6 bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg">
                                            <h3 className="text-lg font-bold text-purple-800">Community ROI</h3>
                                            <p className="text-4xl font-bold text-purple-600 my-4">
                                                {((totalCommunityValue / totalInvestment) * 100).toFixed(0)}%
                                            </p>
                                            <p className="text-sm text-purple-700">Return on community investment</p>
                                        </div>
                                        <div className="text-center p-6 bg-gradient-to-br from-yellow-50 to-yellow-100 rounded-lg">
                                            <h3 className="text-lg font-bold text-yellow-800">Implementation Timeline</h3>
                                            <p className="text-4xl font-bold text-yellow-600 my-4">24</p>
                                            <p className="text-sm text-yellow-700">Months to full implementation</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* ROI Analysis */}
                        {activeView === 'roi-analysis' && (
                            <div className="space-y-6">
                                <div className="bg-white rounded-xl shadow-lg p-6">
                                    <h2 className="text-2xl font-bold text-gray-800 mb-4">5-Year Financial Projection</h2>
                                    <div className="h-96">
                                        <ResponsiveContainer width="100%" height="100%">
                                            <ComposedChart
                                                data={financialTimeline}
                                                margin={{ top: 20, right: 30, left: 20, bottom: 5 }}
                                            >
                                                <CartesianGrid strokeDasharray="3 3" />
                                                <XAxis dataKey="year" />
                                                <YAxis tickFormatter={(value) => `$${(value/1000000).toFixed(1)}M`} />
                                                <Tooltip formatter={(value) => [`$${value.toLocaleString()}`, '']} />
                                                <Legend />
                                                <Area type="monotone" dataKey="value" fill="#10B981" stroke="#10B981" fillOpacity={0.6} name="Annual Value" />
                                                <Line type="monotone" dataKey="cumulative" stroke="#3B82F6" strokeWidth={4} name="Cumulative Net Value" />
                                                <Bar dataKey="investment" fill="#EF4444" name="Annual Investment" />
                                            </ComposedChart>
                                        </ResponsiveContainer>
                                    </div>
                                </div>

                                <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                                    <div className="bg-white rounded-xl shadow-lg p-6">
                                        <h3 className="text-xl font-bold text-gray-800 mb-4">Break-Even Analysis</h3>
                                        <div className="space-y-4">
                                            <div className="text-center p-4 bg-green-50 rounded-lg">
                                                <div className="text-3xl font-bold text-green-600">6 months</div>
                                                <div className="text-sm text-green-700">Average break-even time</div>
                                            </div>
                                            <div className="text-center p-4 bg-blue-50 rounded-lg">
                                                <div className="text-3xl font-bold text-blue-600">
                                                    ${((totalAnnualValue - totalInvestment) / 1000000).toFixed(1)}M
                                                </div>
                                                <div className="text-sm text-blue-700">First year net value</div>
                                            </div>
                                        </div>
                                    </div>

                                    <div className="bg-white rounded-xl shadow-lg p-6">
                                        <h3 className="text-xl font-bold text-gray-800 mb-4">5-Year Totals</h3>
                                        <div className="space-y-4">
                                            <div className="text-center p-4 bg-purple-50 rounded-lg">
                                                <div className="text-3xl font-bold text-purple-600">
                                                    ${(financialTimeline[4].cumulative / 1000000).toFixed(1)}M
                                                </div>
                                                <div className="text-sm text-purple-700">Total net value</div>
                                            </div>
                                            <div className="text-center p-4 bg-yellow-50 rounded-lg">
                                                <div className="text-3xl font-bold text-yellow-600">
                                                    {((financialTimeline[4].cumulative / totalInvestment) * 100).toFixed(0)}%
                                                </div>
                                                <div className="text-sm text-yellow-700">5-year ROI</div>
                                            </div>
                                        </div>
                                    </div>

                                    <div className="bg-white rounded-xl shadow-lg p-6">
                                        <h3 className="text-xl font-bold text-gray-800 mb-4">Risk Assessment</h3>
                                        <div className="space-y-3">
                                            <div className="flex justify-between items-center">
                                                <span className="text-sm text-gray-600">Implementation Risk</span>
                                                <span className="px-2 py-1 bg-green-100 text-green-800 rounded text-sm">Low</span>
                                            </div>
                                            <div className="flex justify-between items-center">
                                                <span className="text-sm text-gray-600">Financial Risk</span>
                                                <span className="px-2 py-1 bg-yellow-100 text-yellow-800 rounded text-sm">Medium</span>
                                            </div>
                                            <div className="flex justify-between items-center">
                                                <span className="text-sm text-gray-600">Market Risk</span>
                                                <span className="px-2 py-1 bg-green-100 text-green-800 rounded text-sm">Low</span>
                                            </div>
                                            <div className="flex justify-between items-center">
                                                <span className="text-sm text-gray-600">Overall Risk</span>
                                                <span className="px-2 py-1 bg-green-100 text-green-800 rounded text-sm">Low</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div className="bg-gradient-to-r from-green-50 to-blue-50 rounded-xl p-8">
                                    <h3 className="text-2xl font-bold text-gray-800 mb-6 text-center">
                                        Investment Summary & Recommendation
                                    </h3>
                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                                        <div className="text-center">
                                            <div className="text-4xl font-bold text-blue-600">
                                                ${(totalInvestment / 1000000).toFixed(1)}M
                                            </div>
                                            <div className="text-sm text-gray-600">Total Investment Required</div>
                                        </div>
                                        <div className="text-center">
                                            <div className="text-4xl font-bold text-green-600">
                                                ${(totalAnnualValue / 1000000).toFixed(1)}M
                                            </div>
                                            <div className="text-sm text-gray-600">Annual Value Creation</div>
                                        </div>
                                        <div className="text-center">
                                            <div className="text-4xl font-bold text-purple-600">
                                                {totalParticipants.toLocaleString()}
                                            </div>
                                            <div className="text-sm text-gray-600">People Directly Served</div>
                                        </div>
                                        <div className="text-center">
                                            <div className="text-4xl font-bold text-yellow-600">
                                                ${(totalCommunityValue / 1000000).toFixed(1)}M
                                            </div>
                                            <div className="text-sm text-gray-600">Community Impact Value</div>
                                        </div>
                                    </div>
                                    <div className="text-center">
                                        <p className="text-lg text-gray-700 max-w-4xl mx-auto leading-relaxed">
                                            The Churches United Sustainability Initiative represents a transformative 
                                            opportunity to eliminate the 2024 financial crisis while building long-term 
                                            organizational resilience. With a combined ROI of {((totalAnnualValue / totalInvestment) * 100).toFixed(0)}% 
                                            in the first year and over ${(financialTimeline[4].cumulative / 1000000).toFixed(1)}M 
                                            in 5-year net value, this comprehensive program portfolio delivers exceptional 
                                            returns while serving {totalParticipants.toLocaleString()} vulnerable community members.
                                        </p>
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>

                    {/* Footer */}
                    <div className="bg-gray-800 text-white mt-12">
                        <div className="max-w-7xl mx-auto px-4 py-8">
                            <div className="text-center">
                                <h3 className="text-xl font-bold mb-2">Churches United Sustainability Initiative</h3>
                                <p className="text-gray-300 mb-4">Complete Program Portfolio Analysis</p>
                                <div className="flex justify-center space-x-8 text-sm">
                                    <div>
                                        <span className="text-gray-400">Programs:</span>
                                        <span className="font-semibold ml-1">{allPrograms.length}</span>
                                    </div>
                                    <div>
                                        <span className="text-gray-400">Total Investment:</span>
                                        <span className="font-semibold ml-1">${(totalInvestment / 1000000).toFixed(1)}M</span>
                                    </div>
                                    <div>
                                        <span className="text-gray-400">Annual Value:</span>
                                        <span className="font-semibold ml-1">${(totalAnnualValue / 1000000).toFixed(1)}M</span>
                                    </div>
                                    <div>
                                        <span className="text-gray-400">Developed by:</span>
                                        <span className="font-semibold ml-1">Timothy Spurlin</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<ComprehensiveImpactAnalysis />, document.getElementById('root'));
    </script>
</body>
</html>
